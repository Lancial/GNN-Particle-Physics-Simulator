<!doctype html>
<html lang="en">

<head>
  <title>hello</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link href="https://fonts.googleapis.com/css?family=Playfair+Display:300,400,700,800|Open+Sans:300,400,700"
    rel="stylesheet">

  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/animate.css">
  <link rel="stylesheet" href="css/owl.carousel.min.css">

  <link rel="stylesheet" href="css/magnific-popup.css">
  <link rel="stylesheet" href="css/aos.css">

  <link rel="stylesheet" href="css/bootstrap-datepicker.css">
  <link rel="stylesheet" href="css/jquery.timepicker.css">

  <link rel="stylesheet" href="fonts/ionicons/css/ionicons.min.css">
  <link rel="stylesheet" href="fonts/fontawesome/css/font-awesome.min.css">

  <link rel="stylesheet" href="fonts/flaticon/font/flaticon.css">

  <!-- Theme Style -->
  <link rel="stylesheet" href="css/style.css">

</head>

<body class="bg-light">

  <body data-spy="scroll" data-target="#ftco-navbar-spy" data-offset="0">

    <div class="site-wrap">

      <nav class="site-menu" id="ftco-navbar-spy">
        <div class="site-menu-inner" id="ftco-navbar">
          <ul class="list-unstyled">
            <li><a href="#section-home">Home</a></li>
            <li><a href="#section-about">About Us</a></li>
            <li><a href="#section-menu">Our Menu</a></li>
            <li><a href="#section-reservation">Reserve A Table</a></li>
            <li><a href="#section-contact">Contact</a></li>
          </ul>
        </div>
      </nav>

      <header class="site-header">
        <div class="row align-items-center">
          <div class="col-5 col-md-3">

          </div>
          <div class="col-2 col-md-6 text-center site-logo-wrap">
            <!-- <a href="index.html" class="site-logo"></a> -->
          </div>
        </div>

      </header> <!-- site-header -->

      <div class="main-wrap " id="section-home">

        <div class="cover_1 overlay bg-light">
          <div class="img_bg" style="background-image: url(images/background.jpg);" data-stellar-background-ratio="0.5">
            <div class="container">
              <div class="row align-items-center justify-content-center text-center">
                <div class="col-md-10" data-aos="fade-up">

                  <!--<h2 class="heading mb-5">Chefing</h2> -->
                  <!-- <p class="smoothscroll btn btn-outline-white px-5 py-3"> Yuansi, Travis, Trung and Xiao</p> -->
                  <!--<p class="smoothscroll btn px-5 py-3"> Yuansi, Travis, Trung and Xiao</p> -->

                </div>
              </div>
            </div>
          </div>
        </div> <!-- .cover_1 -->


        <div class="section" data-aos="fade-up">
          <div class="container">
            <div class="row align-items-center justify-content-center">
              <div class="col-md-12 col-lg-8 section-heading">
                <h2 class="heading mb-5">Introduction</h2>
                <p>Physics simulation has been a well studied field in Computer Graphics. Recently, there has been
                  efforts put in to do essentially the same task with deep learning. In our project, we looked at
                  <a href="https://arxiv.org/abs/2002.09405">this paper</a>. We replicated a navie version of their work
                  and conducted experiments to learn GNN.
                </p>
                <h3>Tools and code we used</h3>
                <p>
                  Follow the same setup as the paper, we used tensorflow 1, sonnet, graph_nets modules to build out
                  network.
                  We adapted the infrastructure such as dataloading, noise generation, and connectivity calculation
                  directly
                  from the original paper.
                </p>
                <h3>Dataset</h3>
                <p>
                  We used the same dataset as the paper. It is generated by SPlisHSPlasH, a SPH-based fluid simulator.
                </p>
                <p>
                  Because we are both new to GNN, we focused more on the understanding other than the implementation
                  side of
                  this project.
                  Experiments presented here are based on modification of the original code base. We also encountered
                  difficulties with the speed of training and evaluation. So here we only present some preliminary
                  results, which are enough to demonstrate substantial understanding of concepts.
                </p>

              </div>
            </div>
          </div> <!-- .section -->
        </div> <!-- .section -->

        <div class="section pb-3 bg-white" id="section-about" data-aos="fade-up">
          <div class="container">
            <div class="row align-items-center justify-content-center">
              <div class="col-md-12 col-lg-8 section-heading">
                <h2 class="heading mb-5">Graph Neural Network</h2>
                <p>Graph neural network is a type of neural network that is based on graph structure. Information flows
                  through the graph via message-passing between each node. To convert a problem into a graph, similar to
                  what generally is done in language processing, we need to encode information first into a graph, then
                  do message-passing steps, then decode the resulting state of the graph. Graph Neural network can
                  easily
                  captures spaitial information(e.g. distance between particles) or logical information(e.g. dependency
                  in a computer program)
                </p>

                <div><img src="images/gnn2.png" alt="Image">
                  <img src="images/gnn1.png" alt="Image"></div>
                </p>
                <h3>Our model structure</h3>
                <p>Input to our model is positions sequences of particles, with a length as a hyperparameter. The idea
                  is to use
                  the k-1 previous position to predict the current position k for each particle.
                </p>
                <p>We preprocessed the data to do a high level feature extraction. We extracted: 1. the most important,
                  connectivity
                  of the graph through using a KDTree. 2. particles' distance to boundary the datset defines. Distance
                  to
                  4 directions are calculated seperately. 3. distance between each nodes, in other words, weights on
                  each edge
                  in a graph. 4. velocity of each particle.
                </p>
                <p>The encoder is responsible for encoding such high level features into a graph where later
                  message-passing are preformed on. In every step of message-passing, information on each node is passed
                  to
                  its neighbors and with several message-passing steps, information is delivered further. Finally a
                  decoder decodes the graph states. Same with the paper, we treat the decoded result as acceleration as
                  we can use euler integration to calculate the next positon.</p>
                <p>Notice that for encoder to encode a node, it uses multilayer perceptrons(MLP), a structure that is
                  very similar to fully-connected layers, to encode node and edge features into a latent vectors.
                  Decoder reverses this process.</p>
                <p>Functionalities that were implemented in the paper are a superset of ours. It included more
                  sophisticated features such as training noise, relative displacement. Our experiments were conducted
                  on
                  top of it</p>
              </div>
            </div>
          </div> <!-- .section -->

          <div class="section pb-3 bg-white" id="section-about" data-aos="fade-up">
            <div class="container">
              <div class="row align-items-center justify-content-center">
                <div class="col-md-12 col-lg-8 section-heading" style="text-align: justify;">
                  <h2 class="heading mb-5">Experiments</h2>
                  <h3>What exactly is the network learning during training?</h3>
                  <p>We used MSE loss during our training as we can easily apply it to accelerations. It is expected the
                    model is going to produce larger error overtime during evalution because predictions are made based
                    on
                    preivous predictions. We were curious of when did the model start learning certain physical
                    properties</p>
                  500 steps:
                  </br>
                  <img src="experiments_related/animation500.gif" width="700" alt="Image">
                  <p>We can see the model already learned property of boundary. It also knows gravity. However, the
                    attaction force seems to be over-represented in the model as clusters of particles are dragged up.
                  </p>
                  1000 steps:
                  </br>
                  <img src="experiments_related/animation1000.gif" width="700" alt="Image">
                  <p>Here we can see the boundary conditions are learned better as particles change direction on the
                    upper boundary.
                    Attraction force between particles are still too strong
                  </p>
                  2000 steps:
                  </br>
                  <img src="experiments_related/animation2000.gif" width="700" alt="Image">
                  <p>Notice that at step of 1000, particles experience a sudden acceleration to the left(we also see it
                    later on), which didn't show up here. We suspect that there is a trend in the datset that when many
                    particles are clustered together, there it is usually moving to the left. So through message
                    passing,
                    the whole clustered gained a leftward acceleration.
                  </p>
                  5000 steps:
                  </br>
                  <img src="experiments_related/animation5000.gif" width="700" alt="Image">
                  <p>Pretty much all phenomena observed previous were still here</p>
                  10000 steps:
                  </br>
                  <img src="experiments_related/animation10000.gif" width="700" alt="Image">
                  <p>We were happy to see that gravity was learned universally. However, when particles were very close
                    to each
                    other, they exhibited no repelling force. Otherwise, they wouldn't statically state at the bottom
                    when they first reached there
                  </p>
                  15000 steps:
                  </br>
                  <img src="experiments_related/animation15000.gif" width="700" alt="Image">
                  <p> Here the problem is more obvious. The physics engine that we used simulates an incompressible
                    fluid.
                    The model was incorrectly ignoring change in volume. But other than that it is very similar to the
                    ground truth
                  </p>
                  20000 steps:
                  </br>
                  <img src="experiments_related/animation20000.gif" width="700" alt="Image">
                  <p>Lastly, some problems came back again. We found out that through out training, the model
                    repetitively
                    generating similar mistakes while learning a new feature, which proves the complexity of the
                    problem. However,
                    every time the mistakes were mitigated. At the last checkpoint, our model captures gravity,
                    boundary, repulsion, and attractions. Through training more steps, the model will be able to
                    produce higher quality result as the paper has demonstrated.
                  </p>
                </div>
              </div>
            </div>
          </div> <!-- .section -->


          <div class="section bg-white" data-aos="fade-up">
            <div class="container">
              <div class="row mb-5">
                <div class="col-md-12 section-heading text-center">
                  <h2 class="heading mb-5">Team</h2>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6 pr-md-5 text-center mb-5">
                  <div class="ftco-38">
                    <div class="ftco-38-img">
                      <div class="ftco-38-header">
                        <img src="images/xiao.png" alt="Image">
                        <h3 class="ftco-38-heading">Xiao Liang</h3>
                        <p class="ftco-38-subheading">UW - Computer Science</p>
                      </div>
                      <div class="ftco-38-body">
                        <p>
                          <a href="" class="p-2"><span class="fa fa-facebook"></span></a>
                          <a href="" class="p-2"><span class="fa fa-twitter"></span></a>
                          <a href="" class="p-2"><span class="fa fa-instagram"></span></a>
                        </p>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-md-6 pl-md-5 text-center mb-5">
                  <div class="ftco-38">
                    <div class="ftco-38-img">
                      <div class="ftco-38-header">
                        <img src="images/xiao.png" alt="Image">
                        <h3 class="ftco-38-heading">Nick Thomas</h3>
                        <p class="ftco-38-subheading">Your department</p>
                      </div>
                      <div class="ftco-38-body">
                        <p>
                          <a href="" class="p-2"><span class="fa fa-facebook"></span></a>
                          <a href="" class="p-2"><span class="fa fa-twitter"></span></a>
                          <a href="" class="p-2"><span class="fa fa-instagram"></span></a>
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

            </div>

            <!-- <div class="col-md-4"></div> -->
          </div>
        </div>
      </div> <!-- .section -->

    </div>

    <!-- loader -->
    <div id="loader" class="show fullscreen"><svg class="circular" width="48px" height="48px">
        <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee" />
        <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
          stroke="#ff7a5c" /></svg></div>

    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/jquery-migrate-3.0.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.waypoints.min.js"></script>

    <script src="js/bootstrap-datepicker.js"></script>
    <script src="js/jquery.timepicker.min.js"></script>
    <script src="js/jquery.stellar.min.js"></script>

    <script src="js/jquery.easing.1.3.js"></script>

    <script src="js/aos.js"></script>


    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false"></script>

    <script src="js/main.js"></script>
  </body>

</html>